<!DOCTYPE html>
<html>
<head>
    <title>LINE LIFFテスト</title>
</head>

<body>
    <!-- ログインボタン -->
    <button onclick="getLineIDToken()">LINEログイン</button>
    <!-- スクリプトを読み込む -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <script type="text/javascript">
        // 多分IDはあってる
        liff.init({
            // LIFF IDはリンクの末尾
            liffId: '2000738317-BrwapmbM'
        }).then(() => {
            console.log('LIFF初期化成功');
        }).catch((err) => {
            // エラーをキャッチ
            console.log(err.code, err.message);
        });
            
        // LINEログインボタンがクリックされたときに呼び出される関数
        function getLineIDToken() {
            if (liff.isLoggedIn()) {
                const idToken = liff.getIDToken();
                
                // IDトークンからユーザーIDを取得
                const userId = idToken.sub;
                
                // LINEプロフィール情報を取得
                liff.getProfile()
                    .then((profile) => {
                        const displayName = profile.displayName;
                        const pictureUrl = profile.pictureUrl;
                        const userId = profile.userId;
                        
                        console.log("ユーザー名：" + displayName);
                        console.log("画像：" + pictureUrl);
                        console.log("ID：" + userId);
                    })
                    .catch((error) => {
                        console.error("プロフィール情報の取得エラー：" + error);
                    });
                
                console.log("idToken: " + idToken);
            } else {
                // ログインされていない場合、ログインを促す
                liff.login();
            }
        }
    </script>
</body>
</html>